{{ config(schema="_airbyte_public", tags=["top-level-intermediate"]) }}
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
select
    cast({{ adapter.quote('id') }} as {{ dbt_utils.type_bigint() }}) as {{ adapter.quote('id') }},
    cast(url as {{ dbt_utils.type_string() }}) as url,
    cast(base as {{ type_json() }}) as base,
    cast(body as {{ dbt_utils.type_string() }}) as body,
    cast(head as {{ type_json() }}) as head,
    {{ cast_to_boolean('draft') }} as draft,
    cast({{ adapter.quote('state') }} as {{ dbt_utils.type_string() }}) as {{ adapter.quote('state') }},
    cast(title as {{ dbt_utils.type_string() }}) as title,
    cast(_links as {{ type_json() }}) as _links,
    labels,
    {{ cast_to_boolean(adapter.quote('locked')) }} as {{ adapter.quote('locked') }},
    cast({{ adapter.quote('number') }} as {{ dbt_utils.type_bigint() }}) as {{ adapter.quote('number') }},
    cast(node_id as {{ dbt_utils.type_string() }}) as node_id,
    cast(user_id as {{ dbt_utils.type_bigint() }}) as user_id,
    cast(diff_url as {{ dbt_utils.type_string() }}) as diff_url,
    cast(html_url as {{ dbt_utils.type_string() }}) as html_url,
    assignees,
    cast(closed_at as {{ dbt_utils.type_string() }}) as closed_at,
    cast(issue_url as {{ dbt_utils.type_string() }}) as issue_url,
    cast(merged_at as {{ dbt_utils.type_string() }}) as merged_at,
    cast(patch_url as {{ dbt_utils.type_string() }}) as patch_url,
    {{ cast_to_boolean('auto_merge') }} as auto_merge,
    cast(created_at as {{ dbt_utils.type_string() }}) as created_at,
    cast(updated_at as {{ dbt_utils.type_string() }}) as updated_at,
    cast(assignee_id as {{ dbt_utils.type_bigint() }}) as assignee_id,
    cast(commits_url as {{ dbt_utils.type_string() }}) as commits_url,
    cast(comments_url as {{ dbt_utils.type_string() }}) as comments_url,
    cast(milestone_id as {{ dbt_utils.type_bigint() }}) as milestone_id,
    cast(statuses_url as {{ dbt_utils.type_string() }}) as statuses_url,
    requested_teams,
    cast(merge_commit_sha as {{ dbt_utils.type_string() }}) as merge_commit_sha,
    cast(active_lock_reason as {{ dbt_utils.type_string() }}) as active_lock_reason,
    cast(author_association as {{ dbt_utils.type_string() }}) as author_association,
    cast(review_comment_url as {{ dbt_utils.type_string() }}) as review_comment_url,
    requested_reviewers,
    cast(review_comments_url as {{ dbt_utils.type_string() }}) as review_comments_url,
    cast(_ab_github_repository as {{ dbt_utils.type_string() }}) as _ab_github_repository,
    _airbyte_emitted_at
from {{ ref('tydo_pull_requests_ab1') }}
-- tydo_pull_requests

